<!DOCTYPE html>
<html lang="es">

<%- include('../partials/head',{title:"Editando un producto nuevo"}) %>

<body class="crear-editar">

    <%- include('../partials/header') %>

    <main>
        <h1>Editando el producto</h1>

        <form action="/admin/editar/<%= producto.id %>?_method=PUT" method="POST" enctype="multipart/form-data"> <!--  toda la informacion sera enviada por metodo PUT a la vista, con method modificamos la query con el metodo PUT-->
            <!--  -->
            <div class="form-floating m-2">
                <select class="form-select" name="Categoria" id="floatingSelect" aria-label="Floating label select example">
                    <% if (locals.errors && old.marca) { %>
                        <option hidden value="">Selecciona una opcion</option>
                        <% marcas.forEach(marca => { %>
                            <% if (marca.id == old.marca) { %>
                                <option value="<%= marca.id %>" selected><%= marca.nombre %></option>
                            <% }else{ %>
                                <option value="<%= marca.id %>"><%= marca.nombre %></option>
                            <% } %>
                            <option value="<%= marca.id %>"><%= marca.nombre %></option>
                        <% }) %>
                    <% }else{ %>
                        <option selected hidden value="">Selecciona una opcion</option>
                        <% marcas.forEach(marca => { %>
                            <option value="<%= marca.id %>" <%= producto.marcasId === marca.id ? "selected" : null %>><%= marca.nombre %></option>
                        <% }) %>
                    <% } %> 
                </select>
                <% if (locals.errors && errors.marca) { %>
                    <p class="span text-danger"><%= errors.marca.msg %></p>
                <% } %>
                <label for="floatingSelect">Marca</label>
                <small>Obligatorio</small> <!-- la idea es que recorra las categorias  -->
             </div>
                <div class="form-floating m-2">
                    <select class="form-select" name="Categoria" id="floatingSelect" aria-label="Floating label select example">
                   
                       <% categorias.forEach(categoria => { %>
                        <option value="<%= categoria.id %>"><%= categoria.nombre %></option>
                      <% }) %> 
                    </select> 
                    <label for="floatingSelect">Categoria</label>
                    <small>Obligatorio</small> <!-- la idea es que recorra las categorias  -->
                 </div>
                 <div class="form-floating m-2">
                     <input type="number" name="Precio" class="form-control" id="Precio" placeholder="Precio" value="<%=producto.precio%>">
                     <label for="Precio m-2">Precio</label>
                     <small>Obligatorio</small>
                    </div>
                    <div class="form-floating m-2">
                        <input type="number" name="Descuento" class="form-control" id="Descuento" placeholder="Descuento" value="<%=producto.descuento%>">
                        <label for="Descuento">Descuento</label>
                    </div>
                    <div class="form-floating m-2">
                        <input type="number" name="Stock" class="form-control" id="Stock" placeholder="Stock" value="<%=producto.stock%>">
                        <label for="Stock">Stock</label>
                    </div>
                    
                    <div class="form-floating m-2">
                        <textarea class="form-control h-100" name="Descripcion" placeholder="Por favor inserte la descripcion del producto"
                            id="floatingTextarea"><%= producto.descripcion %></textarea>
                        <label for="floatingTextarea">Descripcion</label>
                        <small>Obligatorio</small>
                    </div>
    
                    <div class="m-2">
<!--                         <label for="formFileMultiple" name="Imagenes" class="form-label">Subir imagenes del producto</label>
                        <input class="form-control" type="file" id="imagenes" name="imagenes" >
                        <small>Obligatorio</small> -->

                        <label class="form-label" for="product-img">
                            <img id="img-preview" class="img-fluid img-thumbnail imagen-height rounded" src="/img/<%=producto.imagen[0].nombre%>" alt="">
                            <div class="imgHover">
                                <p class="text-center">Selecionar Imagen</p>
                            </div>
                        </label>
                        <div class="form-admin__box inactivo">
                            <input class="form-control" id="imagenes" type="file" name="imagen1" placeholder="Imagen del Producto" accept="image/*" multiple>
                        </div>
                    </div>
                    
                    <div class="button">
                        <button class="btn btn-outline-success" type="submit">Editar Producto</button>
                    </div>
                    
                </section>
            </form>
        </main>
    </body>
    
    </html>